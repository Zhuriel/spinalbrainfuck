import org.scalatest.FunSuite

class SpinalBrainFuckTest extends FunSuite {

  // test programs by daniel b cristofani from brainfuck.org under CC BY-SA 4.0

  test("helloworld") {
    val res = SpinalBrainFuckInterpreter.run(
      "++++++++[>++++[>++>+++>+++>+<<<<-]>+>+>->>+[<]<-]>>.>---.+++++++..+++.>>.<-.<.+++.------.--------.>>+.>++."
    )
    println(res)
    assert(res === "Hello World!\n")
  }

  test("iotest") {
    val res = SpinalBrainFuckInterpreter.run(
      ">,>+++++++++,>+++++++++++[<++++++<++++++<+>>>-]<<.>.<<-.>.>.<<.",
      inputs = "\n\0"
    )
    println(res)
    assert(res === "LB\nLB\n")
  }

  test("h") {
    val res = SpinalBrainFuckInterpreter.run(
      """[]++++++++++[>>+>+>++++++[<<+<+++>>>-]<<<<-]
      "A*$";?@![#>>+<<]>[>>]<<<<[>++<[-]]>.>."""
    )
    assert(res === "H\n")
  }

  test("bubblesort") {
    val res = SpinalBrainFuckInterpreter.run(
      """>>,[>>,]<<[
        [<<]>>>>[
          <<[>+<<+>-]
          >>[>+<<<<[->]>[<]>>-]
          <<<[[-]>>[>+<-]>>[<<<+>>>-]]
          >>[[<+>-]>>]<
        ]<<[>>+<<-]<<
      ]>>>>[.>>]""",
      "acdb\0"
    )
    assert(res === "abcd")
  }

  test("e") {
    val res = SpinalBrainFuckInterpreter.run(
      """>>>>++>+>++>+>>++<+[
          [>[>>[>>>>]<<<<[[>>>>+<<<<-]<<<<]>>>>>>]+<]>-
          >>--[+[+++<<<<--]++>>>>--]+[>>>>]<<<<[<<+<+<]<<[
            >>>>>>[[<<<<+>>>>-]>>>>]<<<<<<<<[<<<<]
            >>-[<<+>>-]+<<[->>>>[-[+>>>>-]-<<-[>>>>-]++>>+[-<<<<+]+>>>>]<<<<[<<<<]]
            >[-[<+>-]]+<[->>>>[-[+>>>>-]-<<<-[>>>>-]++>>>+[-<<<<+]+>>>>]<<<<[<<<<]]<<
          ]>>>+[>>>>]-[+<<<<--]++[<<<<]>>>+[
            >-[
              >>[--[++>>+>>--]-<[-[-[+++<<<<-]+>>>>-]]++>+[-<<<<+]++>>+>>]
              <<[>[<-<<<]+<]>->>>
            ]+>[>>>>]-[+<<<<--]++<[
              [>>>>]<<<<[
                -[+>[<->-]++<[[>-<-]++[<<<<]+>>+>>-]++<<<<-]
                >-[+[<+[<<<<]>]<+>]+<[->->>>[-]]+<<<<
              ]
            ]>[<<<<]>[
              -[
                -[
                  +++++[>++++++++<-]>-.>>>-[<<<----.<]<[<<]>>[-]>->>+[
                    [>>>>]+[-[->>>>+>>>>>>>>-[-[+++<<<<[-]]+>>>>-]++[<<<<]]+<<<<]>>>
                  ]+<+<<
                ]>[
                  -[
                    ->[--[++>>>>--]->[-[-[+++<<<<-]+>>>>-]]++<+[-<<<<+]++>>>>]
                    <<<<[>[<<<<]+<]>->>
                  ]<
                ]>>>>[--[++>>>>--]-<--[+++>>>>--]+>+[-<<<<+]++>>>>]<<<<<[<<<<]<
              ]>[>+<<++<]<
            ]>[+>[--[++>>>>--]->--[+++>>>>--]+<+[-<<<<+]++>>>>]<<<[<<<<]]>>
          ]>
        ]
        """
    )
    println(res)
    assert(res === "2.71828182845")
  }
}